/**
 * LEVEL 11.3 â€” PRESENCE LAYER CSS
 * 
 * GPU-accelerated visual effects for BagBot's living aura.
 * Creates holographic, emotional-visual synchronization.
 * 
 * Structure:
 * - Aura mode effects (warm-flux, focused-glow, harmonic-pulse, deep-presence)
 * - Glow dynamics (intensity, pulse, shimmer)
 * - Flow animations (outward, inward, circular, radial)
 * - Emotional overlays
 * - Accessibility & performance
 */

/* ================================
   CSS CUSTOM PROPERTIES
   ================================ */

:root {
  /* Aura colors - dynamically set by AuraSyncEngine */
  --aura-primary: hsla(280, 70%, 60%, 0.9);
  --aura-secondary: hsla(200, 60%, 65%, 0.7);
  --aura-accent: hsla(320, 80%, 70%, 0.5);
  
  /* Aura dynamics */
  --aura-glow-intensity: 65%;
  --aura-pulse-speed: 1.5s;
  --aura-expansiveness: 60%;
  --aura-shimmer: 40%;
  --aura-flow-speed: 2.25s;
  --aura-coherence: 85%;
  
  /* Base values */
  --aura-base-blur: 40px;
  --aura-base-spread: 20px;
}

/* ================================
   AURA CONTAINER
   ================================ */

.presence-aura {
  position: relative;
  isolation: isolate;
  
  /* GPU acceleration */
  will-change: filter, transform;
  transform: translateZ(0);
  
  /* Accessibility */
  @media (prefers-reduced-motion: reduce) {
    animation: none !important;
  }
}

/* ================================
   AURA MODES
   ================================ */

/* Warm Flux - gentle, supportive energy */
.presence-aura--warm-flux {
  --mode-glow: 0 0 calc(var(--aura-base-blur) * 0.8) var(--aura-primary),
               0 0 calc(var(--aura-base-blur) * 1.2) var(--aura-secondary);
  
  filter: drop-shadow(var(--mode-glow));
  animation: warm-flux-breathe var(--aura-pulse-speed) ease-in-out infinite;
}

@keyframes warm-flux-breathe {
  0%, 100% {
    filter: drop-shadow(0 0 calc(var(--aura-base-blur) * 0.8) var(--aura-primary))
            drop-shadow(0 0 calc(var(--aura-base-blur) * 1.2) var(--aura-secondary));
    transform: scale(1);
  }
  50% {
    filter: drop-shadow(0 0 calc(var(--aura-base-blur) * 1.1) var(--aura-primary))
            drop-shadow(0 0 calc(var(--aura-base-blur) * 1.5) var(--aura-secondary));
    transform: scale(1.02);
  }
}

/* Focused Glow - concentrated, analytical presence */
.presence-aura--focused-glow {
  --mode-glow: 0 0 calc(var(--aura-base-blur) * 0.5) var(--aura-primary),
               0 0 calc(var(--aura-base-blur) * 0.3) var(--aura-accent);
  
  filter: drop-shadow(var(--mode-glow)) brightness(1.1);
  animation: focused-glow-steady var(--aura-pulse-speed) linear infinite;
}

@keyframes focused-glow-steady {
  0%, 100% {
    filter: drop-shadow(0 0 calc(var(--aura-base-blur) * 0.5) var(--aura-primary))
            drop-shadow(0 0 calc(var(--aura-base-blur) * 0.3) var(--aura-accent))
            brightness(1.1);
  }
  50% {
    filter: drop-shadow(0 0 calc(var(--aura-base-blur) * 0.6) var(--aura-primary))
            drop-shadow(0 0 calc(var(--aura-base-blur) * 0.4) var(--aura-accent))
            brightness(1.15);
  }
}

/* Harmonic Pulse - energetic, playful oscillation */
.presence-aura--harmonic-pulse {
  --mode-glow: 0 0 calc(var(--aura-base-blur) * 1.0) var(--aura-primary),
               0 0 calc(var(--aura-base-blur) * 0.8) var(--aura-accent);
  
  filter: drop-shadow(var(--mode-glow));
  animation: harmonic-pulse-oscillate calc(var(--aura-pulse-speed) * 0.7) ease-in-out infinite;
}

@keyframes harmonic-pulse-oscillate {
  0%, 100% {
    filter: drop-shadow(0 0 calc(var(--aura-base-blur) * 1.0) var(--aura-primary))
            drop-shadow(0 0 calc(var(--aura-base-blur) * 0.8) var(--aura-accent));
    transform: scale(1) rotate(0deg);
  }
  25% {
    filter: drop-shadow(0 0 calc(var(--aura-base-blur) * 1.3) var(--aura-accent))
            drop-shadow(0 0 calc(var(--aura-base-blur) * 1.0) var(--aura-primary));
    transform: scale(1.04) rotate(1deg);
  }
  50% {
    filter: drop-shadow(0 0 calc(var(--aura-base-blur) * 1.0) var(--aura-primary))
            drop-shadow(0 0 calc(var(--aura-base-blur) * 0.8) var(--aura-accent));
    transform: scale(1) rotate(0deg);
  }
  75% {
    filter: drop-shadow(0 0 calc(var(--aura-base-blur) * 1.3) var(--aura-accent))
            drop-shadow(0 0 calc(var(--aura-base-blur) * 1.0) var(--aura-primary));
    transform: scale(1.04) rotate(-1deg);
  }
}

/* Deep Presence - calm, grounded energy */
.presence-aura--deep-presence {
  --mode-glow: 0 0 calc(var(--aura-base-blur) * 1.5) var(--aura-primary),
               0 0 calc(var(--aura-base-blur) * 2.0) var(--aura-secondary);
  
  filter: drop-shadow(var(--mode-glow));
  animation: deep-presence-slow-breathe calc(var(--aura-pulse-speed) * 1.5) ease-in-out infinite;
}

@keyframes deep-presence-slow-breathe {
  0%, 100% {
    filter: drop-shadow(0 0 calc(var(--aura-base-blur) * 1.5) var(--aura-primary))
            drop-shadow(0 0 calc(var(--aura-base-blur) * 2.0) var(--aura-secondary));
    transform: scale(1);
    opacity: 0.95;
  }
  50% {
    filter: drop-shadow(0 0 calc(var(--aura-base-blur) * 1.8) var(--aura-primary))
            drop-shadow(0 0 calc(var(--aura-base-blur) * 2.3) var(--aura-secondary));
    transform: scale(1.01);
    opacity: 1;
  }
}

/* ================================
   GLOW INTENSITY MODIFIERS
   ================================ */

.presence-aura--glow-low {
  filter: opacity(0.6) var(--mode-glow);
}

.presence-aura--glow-medium {
  filter: opacity(0.8) var(--mode-glow);
}

.presence-aura--glow-high {
  filter: opacity(1) var(--mode-glow) brightness(1.1);
}

.presence-aura--glow-intense {
  filter: opacity(1) var(--mode-glow) brightness(1.2) saturate(1.1);
}

/* ================================
   SHIMMER EFFECTS
   ================================ */

.presence-aura--shimmer::after {
  content: '';
  position: absolute;
  inset: -20%;
  background: linear-gradient(
    120deg,
    transparent 30%,
    var(--aura-accent) 50%,
    transparent 70%
  );
  opacity: calc(var(--aura-shimmer) / 100 * 0.3);
  animation: shimmer-sweep calc(var(--aura-flow-speed) * 2) linear infinite;
  pointer-events: none;
  mix-blend-mode: overlay;
}

@keyframes shimmer-sweep {
  0% {
    transform: translateX(-100%) translateY(-100%);
  }
  100% {
    transform: translateX(100%) translateY(100%);
  }
}

/* ================================
   FLOW ANIMATIONS
   ================================ */

/* Outward flow */
.presence-aura--flow-outward {
  animation-name: flow-outward, var(--aura-mode-animation);
  animation-duration: var(--aura-flow-speed), var(--aura-pulse-speed);
  animation-timing-function: ease-out, ease-in-out;
  animation-iteration-count: infinite, infinite;
}

@keyframes flow-outward {
  0% {
    box-shadow: 0 0 0 0 var(--aura-primary);
    transform: scale(1);
  }
  50% {
    box-shadow: 0 0 40px 20px transparent;
    transform: scale(1.05);
  }
  100% {
    box-shadow: 0 0 0 0 var(--aura-primary);
    transform: scale(1);
  }
}

/* Inward flow */
.presence-aura--flow-inward {
  animation-name: flow-inward, var(--aura-mode-animation);
  animation-duration: var(--aura-flow-speed), var(--aura-pulse-speed);
  animation-timing-function: ease-in, ease-in-out;
  animation-iteration-count: infinite, infinite;
}

@keyframes flow-inward {
  0% {
    box-shadow: 0 0 40px 20px var(--aura-primary);
    transform: scale(1.03);
  }
  50% {
    box-shadow: 0 0 10px 5px var(--aura-primary);
    transform: scale(0.98);
  }
  100% {
    box-shadow: 0 0 40px 20px var(--aura-primary);
    transform: scale(1.03);
  }
}

/* Circular flow */
.presence-aura--flow-circular::before {
  content: '';
  position: absolute;
  inset: -30%;
  background: conic-gradient(
    from 0deg,
    transparent,
    var(--aura-primary),
    transparent,
    var(--aura-secondary),
    transparent
  );
  opacity: 0.3;
  animation: flow-circular-rotate var(--aura-flow-speed) linear infinite;
  pointer-events: none;
  border-radius: 50%;
  filter: blur(30px);
}

@keyframes flow-circular-rotate {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

/* Radial flow */
.presence-aura--flow-radial {
  position: relative;
}

.presence-aura--flow-radial::before {
  content: '';
  position: absolute;
  inset: -20%;
  background: radial-gradient(
    circle,
    var(--aura-primary) 0%,
    transparent 70%
  );
  opacity: 0.4;
  animation: flow-radial-pulse var(--aura-flow-speed) ease-in-out infinite;
  pointer-events: none;
  border-radius: 50%;
}

@keyframes flow-radial-pulse {
  0%, 100% {
    transform: scale(0.8);
    opacity: 0.4;
  }
  50% {
    transform: scale(1.2);
    opacity: 0.2;
  }
}

/* ================================
   EMOTIONAL OVERLAYS
   ================================ */

/* Calm overlay */
.presence-aura--emotion-calm {
  filter: saturate(0.9) brightness(0.95) var(--mode-glow);
}

/* Excited overlay */
.presence-aura--emotion-excited {
  filter: saturate(1.2) brightness(1.15) var(--mode-glow);
  animation-duration: calc(var(--aura-pulse-speed) * 0.6);
}

/* Focused overlay */
.presence-aura--emotion-focused {
  filter: saturate(0.85) contrast(1.1) var(--mode-glow);
}

/* Supportive overlay */
.presence-aura--emotion-supportive {
  filter: saturate(1.1) hue-rotate(-10deg) var(--mode-glow);
}

/* Intense overlay */
.presence-aura--emotion-intense {
  filter: saturate(1.3) brightness(1.2) contrast(1.1) var(--mode-glow);
  animation-duration: calc(var(--aura-pulse-speed) * 0.5);
}

/* Analytical overlay */
.presence-aura--emotion-analytical {
  filter: saturate(0.7) brightness(1.05) var(--mode-glow);
}

/* Playful overlay */
.presence-aura--emotion-playful {
  filter: saturate(1.25) hue-rotate(10deg) brightness(1.1) var(--mode-glow);
}

/* ================================
   EXPANSIVENESS MODIFIERS
   ================================ */

.presence-aura--expansive-low {
  transform: scale(0.95);
}

.presence-aura--expansive-medium {
  transform: scale(1);
}

.presence-aura--expansive-high {
  transform: scale(1.05);
}

.presence-aura--expansive-full {
  transform: scale(1.1);
}

/* ================================
   COHERENCE INDICATORS
   ================================ */

.presence-aura--coherence-low {
  filter: blur(2px) var(--mode-glow);
  opacity: 0.7;
}

.presence-aura--coherence-medium {
  filter: blur(0.5px) var(--mode-glow);
  opacity: 0.85;
}

.presence-aura--coherence-high {
  filter: var(--mode-glow);
  opacity: 1;
}

/* ================================
   TRAJECTORY EFFECTS
   ================================ */

/* Rising trajectory */
.presence-aura--trajectory-rise {
  animation-name: trajectory-rise, var(--aura-mode-animation);
  animation-duration: 2s, var(--aura-pulse-speed);
  animation-timing-function: ease-out, ease-in-out;
  animation-iteration-count: 1, infinite;
  animation-fill-mode: forwards, none;
}

@keyframes trajectory-rise {
  0% {
    filter: var(--mode-glow);
    transform: scale(1);
  }
  100% {
    filter: var(--mode-glow) brightness(1.2);
    transform: scale(1.08);
  }
}

/* Falling trajectory */
.presence-aura--trajectory-fall {
  animation-name: trajectory-fall, var(--aura-mode-animation);
  animation-duration: 2s, var(--aura-pulse-speed);
  animation-timing-function: ease-in, ease-in-out;
  animation-iteration-count: 1, infinite;
  animation-fill-mode: forwards, none;
}

@keyframes trajectory-fall {
  0% {
    filter: var(--mode-glow) brightness(1.1);
    transform: scale(1.05);
  }
  100% {
    filter: var(--mode-glow);
    transform: scale(1);
  }
}

/* Flare trajectory */
.presence-aura--trajectory-flare {
  animation: trajectory-flare 0.8s ease-out forwards;
}

@keyframes trajectory-flare {
  0% {
    filter: var(--mode-glow);
    transform: scale(1);
  }
  30% {
    filter: var(--mode-glow) brightness(1.5) saturate(1.3);
    transform: scale(1.15);
  }
  100% {
    filter: var(--mode-glow) brightness(1.1);
    transform: scale(1.05);
  }
}

/* ================================
   INTERACTIVE STATES
   ================================ */

.presence-aura--active {
  filter: var(--mode-glow) brightness(1.15);
  animation-duration: calc(var(--aura-pulse-speed) * 0.8);
}

.presence-aura--thinking::after {
  content: '';
  position: absolute;
  inset: -10%;
  border-radius: 50%;
  border: 2px solid var(--aura-accent);
  opacity: 0;
  animation: thinking-pulse 1.5s ease-in-out infinite;
  pointer-events: none;
}

@keyframes thinking-pulse {
  0% {
    transform: scale(0.9);
    opacity: 0;
  }
  50% {
    transform: scale(1.1);
    opacity: 0.6;
  }
  100% {
    transform: scale(1.3);
    opacity: 0;
  }
}

.presence-aura--responding {
  animation-name: responding-flicker, var(--aura-mode-animation);
  animation-duration: 0.3s, var(--aura-pulse-speed);
  animation-timing-function: ease-in-out, ease-in-out;
  animation-iteration-count: 3, infinite;
}

@keyframes responding-flicker {
  0%, 100% {
    filter: var(--mode-glow);
  }
  50% {
    filter: var(--mode-glow) brightness(1.3);
  }
}

/* ================================
   ACCESSIBILITY
   ================================ */

@media (prefers-reduced-motion: reduce) {
  .presence-aura,
  .presence-aura::before,
  .presence-aura::after {
    animation: none !important;
    transition: none !important;
  }
  
  .presence-aura {
    filter: var(--mode-glow);
    transform: none;
  }
}

@media (prefers-contrast: high) {
  .presence-aura {
    filter: contrast(1.2) var(--mode-glow);
  }
}

/* ================================
   PERFORMANCE OPTIMIZATION
   ================================ */

.presence-aura {
  /* GPU layer promotion */
  will-change: filter, transform, opacity;
  transform: translateZ(0);
  backface-visibility: hidden;
  
  /* Containment */
  contain: layout style paint;
}

.presence-aura::before,
.presence-aura::after {
  will-change: transform, opacity;
  transform: translateZ(0);
}

/* Disable expensive effects on low-end devices */
@media (max-width: 768px), (prefers-reduced-motion: reduce) {
  .presence-aura::before,
  .presence-aura::after {
    display: none;
  }
  
  .presence-aura {
    filter: var(--mode-glow);
    animation: none;
  }
}
